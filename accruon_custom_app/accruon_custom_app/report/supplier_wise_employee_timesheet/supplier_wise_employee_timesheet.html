{%
	var report_columns = report.get_columns_for_print();
	report_columns = report_columns.filter(col => !col.hidden);

	if (report_columns.length > 50) {
		frappe.throw(__("Too many columns. Export the report and print it using a spreadsheet application."));
	}
%}

<style>
	.financial-statements-important td {
		font-weight: bold;
	}

	.financial-statements-blank-row td {
		height: 20px;
	}
    .table {
        width: 100%;
        table-layout: fixed;
        border-collapse: collapse;
    }

    .table th, .table td {
        border: 1px solid #ddd;
        font-size: 7px;
        padding: 2px;
        text-align: center;
        white-space: nowrap;
        overflow: hidden;
        text-overflow: ellipsis;
    }
    
    @media print {
        body {
            margin: 0;
        }

        table th, .table td {
            font-size: 8px;
        }
    }
</style>

<h2 class="text-center" style="font-size: 30px;">{%= filters.company %}</h2>
<h2 class="text-center" style="font-size: 12px;"><b></b></h2>
 

{% if 'supplier' in filters %}
	<h3 class="text-center">Timesheet {%= filters.supplier %}</h3>
{% endif %}

<h3 class="text-center">{%= filters.year %}</h3>
<h3 class="text-center">{%= filters.month %}</h3>
<table class="table table-bordered">
    <colgroup>
        <col style="width: 10%;"> 
        {% for (let i = 1, l = report_columns.length; i < l; i++) { %}
            <col style="width: {{ 80 / (report_columns.length - 1) }}%;"> 
        {% } %}
    </colgroup>
	<thead>
		<tr>
			{% for (let i = 1, l = report_columns.length; i < l; i++) { %}
                {% if (report_columns[i].label != "Supplier") { %}
				    <th class="text-right">{%= report_columns[i].label %}</th>
                {% } %}
			{% } %}
		</tr>
	</thead>
	<tbody>
        {% for (let j = 0, k = data.length; j < k; j++) { %}
            {%
                var row = data[j];
            %}
            <tr>
                <td style="width:auto;"><span>{%= row.employee_name %}</span></td>
                {% for (let i = 3, l = report_columns.length; i < l; i++) { %}
                    <td class="text-right">
                        {% const fieldname = report_columns[i].fieldname; %}
                        {% if (!is_null(row[fieldname])) { %}
                            {%= frappe.format(row[fieldname], report_columns[i], {}, row) %}
                        {% } %}
                    </td>
                {% } %}
            </tr>
        {% } %}
    </tbody>
</table>
<p class="text-right text-muted">
	Printed On {%= frappe.datetime.str_to_user(frappe.datetime.get_datetime_as_string()) %}
</p>
